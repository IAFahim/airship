using Airship.Editor;
using Mirror;
using UnityEditor;
using UnityEngine;
using UnityToolbarExtender;

[InitializeOnLoad]
public static class LocalCharacterSelector {
    static LocalCharacterSelector() {
        ToolbarExtender.LeftToolbarGUI.Add(OnToolbarGUI);
    }

    private static void OnToolbarGUI() {
        if (!Application.isPlaying || !RunCore.IsClient()) return;
        
        GUILayout.FlexibleSpace();
        if (GUILayout.Button(new GUIContent("Select Local Character", "Select the local entity"),
                ToolbarStyles.LocalCharacterButtonStyle)) {
            var ids = Object.FindObjectsByType<NetworkIdentity>(FindObjectsSortMode.None);
            foreach (var id in ids) {
                if (id.isOwned) {
                    Selection.activeGameObject = id.gameObject;
                    break;
                }
            }
        }
    }
}
